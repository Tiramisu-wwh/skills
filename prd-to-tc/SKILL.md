---
name: prd-to-tc-generator
description: AI驱动的PRD测试用例生成器，使用Claude智能分析Word/PDF文档和Figma设计，创建结构化测试用例表格和Midscene兼容的UI自动化脚本。当Claude需要从PRD文档生成综合测试用例时使用：(1) 需求分析和测试规划，(2) 功能和UI测试用例创建，(3) Midscene自动化脚本生成。
---

# PRD测试用例生成器

## AI驱动的智能测试用例生成

当用户提供PRD文档路径时，我(Claude AI)将：

### 1. 智能解析PRD内容
- 使用脚本提取文档文本、表格和结构信息
- 深度理解业务需求和用户故事
- 识别功能模块、UI要求和业务流程

### 2. AI生成测试用例
- 为每个功能需求生成正向、异常、边界测试用例
- 创建具体的UI自动化测试步骤
- 提供可执行的测试数据和验证点

### 3. 格式化导出
- 生成Excel格式的标准测试用例表格
- 创建Markdown格式的UI自动化测试用例
- 提供完整的测试统计和分析报告

## 使用方法

### 输入格式
用户提供以下任一格式：
- Word文档路径 (.docx)
- PDF文档路径 (.pdf)
- Figma设计链接
- 直接粘贴PRD文本内容

### 处理流程

#### 阶段1：文档内容提取
我使用辅助脚本提取原始内容：
- Word: `python scripts/content_extractor.py --word <文件路径>`
- PDF: `python scripts/content_extractor.py --pdf <文件路径>`
- Figma: `python scripts/figma_extractor.py <链接>`

#### 阶段2：AI智能分析
我基于提取的内容进行深度分析：

**需求分析**：
- 识别功能需求、非功能需求、约束条件
- 分析用户角色和使用场景
- 梳理业务流程和数据流转
- 理解UI设计和交互要求

**测试策略制定**：
- 确定测试范围和优先级
- 设计测试类型分布（功能/性能/安全/兼容性）
- 制定边界值和异常场景
- 规划测试数据和验证点

#### 阶段3：AI测试用例生成

**功能测试用例**：参考 `references/test_case_template.md`
- 正向测试：验证正常业务流程
- 异常测试：验证错误处理和边界条件
- 数据测试：验证数据完整性和准确性
- 集成测试：验证模块间交互

**UI自动化测试用例**：参考 `references/midscene_patterns.md`
- 自然语言描述的测试步骤
- 具体的元素定位和交互描述
- 完整的验证断言和预期结果
- 错误处理和恢复机制

#### 阶段4：结果导出

**创建输出文件的文件夹**：
- 在PRD所在目录创建文件夹
**文件命名**：PRD名称+YYYY-MM-DDTHH-mm-SS
- 后续生成的文件都放在该文件夹内

**功能测试用例CSV导出要求**：
**重要：生成CSV格式文件，使用制表符分隔，Excel可以完美打开和编辑**
- 使用 `Write` 工具生成 `.csv` 格式文件，字段用制表符(`\t`)分隔
- **首先参考 `assets/基础用例模板.csv` 文件结构**，确保列名和格式完全一致
- 如果模板文件存在，先使用Read工具读取模板，获取标准的列名和格式

**模板参考步骤**：
1. 使用Read工具读取 `assets/基础用例模板.csv` 文件（如果存在）
2. 分析模板的列名结构和格式
3. 按照模板结构生成对应的CSV内容
4. 确保字段顺序和命名与模板完全一致

**标准CSV格式**：
- 第一行为表头，字段用制表符分隔
- 每行一个测试用例，字段用制表符分隔
- 测试步骤用换行符(`\n`)分隔，保持在单个单元格内
- 文件编码为UTF-8，确保中文正常显示

**标准字段结构**（严格遵循模板）
**文件命名**：测试用例_YYYY-MM-DDTHH-mm-SS.csv

**UI自动化用例导出要求**：
- 使用Markdown格式，包含完整阶段3生成的UI自动化测试用例内容
**文件命名**：UI测试用例_YYYY-MM-DDTHH-mm-SS.md

**测试分析报告导出要求**：
**文件命名**：测试分析报告_YYYY-MM-DDTHH-mm-SS.md

## 示例使用

```
用户: 请分析这个PRD文档生成测试用例：/path/to/prd.docx

我: 1. 正在提取文档内容...
   2. 完成需求分析，识别出15个功能需求
   3. 生成45个测试用例（含正向/异常/边界测试）
   4. 创建12个UI自动化测试用例
   5. 导出Excel和Markdown格式结果

   结果文件：
   - test_cases_20241128.csv (45个测试用例)
   - ui_tests_20241128.md (12个UI测试用例)
```

## 依赖要求

运行辅助脚本需要：
```bash
pip install python-docx pandas openpyxl PyPDF2
```

## 优化后的实现架构

### 技能文件结构
```
.claude/skills/prd-to-tc/
├── SKILL.md                    # 技能说明文档
└── scripts/
    ├── content_extractor.py    # 文档内容提取器
    └── figma_extractor.py      # Figma设计提取器
```

### 优化要点

1. **明确的职责分离**：
   - Claude AI：负责需求分析、测试用例设计、智能决策和结果输出
   - 脚本：仅负责文档内容提取的技术性操作

2. **简化的调用流程**：
   - 使用脚本提取原始文档内容
   - Claude AI直接分析并生成完整测试用例
   - 直接输出到目标格式文件

3. **更好的用户体验**：
   - 清晰的进度反馈
   - 标准化的输出格式
   - 零配置的简单使用方式

## 直接使用方式

现在你可以直接对我说：
```
"请分析这个PRD文档生成测试用例：/path/to/document.docx"
```

我将：
1. 自动提取文档内容
2. 进行AI智能分析
3. 生成完整的测试用例
4. 导出Excel和Markdown格式文件